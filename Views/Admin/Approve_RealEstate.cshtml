@model IEnumerable<Website_BDS.Models.Product>

@{
    ViewBag.Title = "Duyệt tin đăng";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="card-box" style="background:white; padding:20px; border-radius:10px;">
    <h2 style="margin-bottom:20px;">Danh sách tin chờ duyệt (@Model.Count())</h2>

    @if (Model.Any())
    {
        <table class="table" style="width:100%; border-collapse: collapse;">
            <thead>
                <tr style="background:#f3f4f6; text-align:left;">
                    <th style="padding:10px;">Hình ảnh</th>
                    <th style="padding:10px;">Tiêu đề / Giá</th>
                    <th style="padding:10px;">Người đăng</th>
                    <th style="padding:10px;">Ngày gửi</th>
                    <th style="padding:10px; text-align:center;">Hành động</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr style="border-bottom:1px solid #eee;">
                        <td style="padding:10px;">
                            @{
                                var img = item.PropertyImages.FirstOrDefault(x => x.IsPrimary == true)?.ImageUrl ?? "~/Font-end/asset/icon/Product_Null.jpg";
                            }
                            <img src="@Url.Content(img)" style="width:80px; height:60px; object-fit:cover; border-radius:5px;" />
                        </td>
                        <td style="padding:10px;">
                            <a href="@Url.Action("Product_details", "Product", new { id = item.ProductID })" target="_blank" style="font-weight:bold; color:#333; text-decoration:none;">
                                @item.Title
                            </a>
                            <br />
                            <span style="color:#d32f2f; font-weight:bold;">@string.Format("{0:N0}", item.Price) VNĐ</span>
                        </td>
                        <td style="padding:10px;">
                            @(item.User != null ? item.User.FullName : "Ẩn danh")
                        </td>
                        <td style="padding:10px;">
                            @(item.CreatedAt.HasValue ? item.CreatedAt.Value.ToString("dd/MM/yyyy HH:mm") : "")
                        </td>
                        <td style="padding:10px; text-align:center;">
                            <a href="@Url.Action("Confirm_Approve", new { id = item.ProductID })"
                               style="background:#22c55e; color:white; padding:6px 12px; border-radius:4px; text-decoration:none; margin-right:5px;">
                                <i class="fa-solid fa-check"></i> Duyệt
                            </a>

                            <a href="@Url.Action("Confirm_Reject", new { id = item.ProductID })"
                               onclick="return confirm('Bạn có chắc chắn muốn từ chối/xóa tin này?');"
                               style="background:#ef4444; color:white; padding:6px 12px; border-radius:4px; text-decoration:none;">
                                <i class="fa-solid fa-xmark"></i> Xóa
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <div style="text-align:center; padding:40px; color:#888;">
            <i class="fa-solid fa-clipboard-check" style="font-size:40px; margin-bottom:10px;"></i>
            <p>Hiện không có tin nào cần duyệt.</p>
        </div>
    }
</div>