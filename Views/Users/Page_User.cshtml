@model Website_BDS.Models.ViewModel.UserProfileViewModel
@{
    string userName = Model?.User?.FullName ?? "Người dùng";
    ViewBag.Title = "Trang cá nhân - " + userName;
    Layout = "~/Views/Shared/_LayoutPageUser.cshtml";
}
<link rel="stylesheet" href="@Url.Content("~/Font-end/asset/reset.css")" />
<link rel="stylesheet" href="@Url.Content("~/Font-end/asset/base.css")" />
<link rel="stylesheet" href="@Url.Content("~/Font-end/CSS/LayoutHome.css")" />
<link rel="stylesheet" href="@Url.Content("~/Font-end/CSS/Page-User.css")" />



<!-- DANH SÁCH TIN -->
<div class="post-list-container">

    <h3 class="section-title">Quản lý bài đăng</h3>

    <div class="listing-summary">
        <div class="listing-status-item"><span class="listing-label">Tất cả</span><span class="listing-count">@Model.Products.Count()</span></div>
        <div class="listing-status-item"><span class="listing-label">Tin chưa duyệt</span><span class="listing-count">0</span></div>
        <div class="listing-status-item"><span class="listing-label">Tin hết hạn</span><span class="listing-count">0</span></div>
    </div>

    @foreach (var item in Model.Products)
    {
        <div class="post-item-card">
            <div class="post-info">
                <div class="post-thumb">
                    <img src="~/Font-end/asset/icon/Product_Null.jpg" />
                </div>
                <div class="post-text">
                    <h4>@item.Title</h4>
                    <p>@String.Format("{0:N0} VNĐ", item.Price) - @item.Address</p>
                </div>
            </div>

            <i class="fa-solid fa-gear action-gear" data-id="@item.ProductID"></i>

            <div class="action-menu" id="menu-@item.ProductID">
                <a href="@Url.Action("Details", "Products", new { id = item.ProductID })">Xem</a>
                <a href="@Url.Action("Edit", "RealEstate", new { id = item.ProductID })">Sửa</a>
                <a href="@Url.Action("Delete", "Products", new { id = item.ProductID })"
                   onclick="return confirm('Xóa bài đăng này?')">Xóa</a>
            </div>
        </div>
    }
</div>

<script>
    // Toggle setting gear
    document.addEventListener("click", function (e) {
        if (e.target.classList.contains("action-gear")) {
            let id = e.target.dataset.id;
            let menu = document.getElementById("menu-" + id);

            document.querySelectorAll(".action-menu").forEach(m => {
                if (m !== menu) m.style.display = "none";
            });

            menu.style.display = (menu.style.display === "block") ? "none" : "block";
        }
        else if (!e.target.closest(".post-item-card")) {
            document.querySelectorAll(".action-menu").forEach(m => m.style.display = "none");
        }
    });
</script>
